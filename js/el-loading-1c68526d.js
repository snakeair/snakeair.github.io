import{aO as e,r as t,a1 as n,A as l,aP as o,al as s,aQ as a,s as i,j as r,h as u,q as c,aR as d,ac as v,ab as m,a3 as b,l as g,aS as f}from"../default/default-e56e1766.js";import{c as p,u as x,b as y}from"./base-140716b6.js";const C=(e="")=>e.split(" ").filter(e=>!!e.trim()),k=(e,t)=>{e&&t.trim()&&e.classList.add(...C(t))},w=(e,t)=>{e&&t.trim()&&e.classList.remove(...C(t))},L=(t,n)=>{var l;if(!p||!t||!n)return"";let o=e(n);"float"===o&&(o="cssFloat");try{const e=t.style[o];if(e)return e;const n=null==(l=document.defaultView)?void 0:l.getComputedStyle(t,"");return n?n[o]:""}catch(s){return t.style[o]}},h=t(0);function A(e){let n;const v=y("loading"),m=t(!1),b=l({...e,originalPosition:"",originalOverflow:"",visible:!1});function g(){var e,t;null==(t=null==(e=x.$el)?void 0:e.parentNode)||t.removeChild(x.$el)}function f(){if(!m.value)return;const e=b.parent;m.value=!1,e.vLoadingAddClassList=void 0,function(){const e=b.parent;if(!e.vLoadingAddClassList){let t=e.getAttribute("loading-number");t=Number.parseInt(t)-1,t?e.setAttribute("loading-number",t.toString()):(w(e,v.bm("parent","relative")),e.removeAttribute("loading-number")),w(e,v.bm("parent","hidden"))}g(),p.unmount()}()}const p=o({name:"ElLoading",setup:()=>()=>{const e=b.spinner||b.svg,t=a("svg",{class:"circular",viewBox:b.svgViewBox?b.svgViewBox:"0 0 50 50",...e?{innerHTML:e}:{}},[a("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),n=b.text?a("p",{class:v.b("text")},[b.text]):void 0;return a(d,{name:v.b("fade"),onAfterLeave:f},{default:i(()=>[r(u("div",{style:{backgroundColor:b.background||""},class:[v.b("mask"),b.customClass,b.fullscreen?"is-fullscreen":""]},[a("div",{class:v.b("spinner")},[t,n])]),[[c,b.visible]])])})}}),x=p.mount(document.createElement("div"));return{...s(b),setText:function(e){b.text=e},removeElLoadingChild:g,close:function(){var t;e.beforeClose&&!e.beforeClose()||(m.value=!0,clearTimeout(n),n=window.setTimeout(f,400),b.visible=!1,null==(t=e.closed)||t.call(e))},handleAfterLeave:f,vm:x,get $el(){return x.$el}}}let V;const $=function(e={}){if(!p)return;const t=B(e);if(t.fullscreen&&V)return V;const n=A({...t,closed:()=>{var e;null==(e=t.closed)||e.call(t),t.fullscreen&&(V=void 0)}});I(t,t.parent,n),P(t,t.parent,n),t.parent.vLoadingAddClassList=()=>P(t,t.parent,n);let l=t.parent.getAttribute("loading-number");return l=l?`${Number.parseInt(l)+1}`:"1",t.parent.setAttribute("loading-number",l),t.parent.appendChild(n.$el),v(()=>n.visible.value=t.visible),t.fullscreen&&(V=n),n},B=e=>{var t,n,l,o;let s;return s=m(e.target)?null!=(t=document.querySelector(e.target))?t:document.body:e.target||document.body,{parent:s===document.body||e.body?document.body:s,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:s===document.body&&(null==(n=e.fullscreen)||n),lock:null!=(l=e.lock)&&l,customClass:e.customClass||"",visible:null==(o=e.visible)||o,target:s}},I=async(e,t,l)=>{const{nextZIndex:o}=(()=>{const e=x("zIndex",2e3),t=n(()=>e.value+h.value);return{initialZIndex:e,currentZIndex:t,nextZIndex:()=>(h.value++,t.value)}})(),s={};if(e.fullscreen)l.originalPosition.value=L(document.body,"position"),l.originalOverflow.value=L(document.body,"overflow"),s.zIndex=o();else if(e.parent===document.body){l.originalPosition.value=L(document.body,"position"),await v();for(const t of["top","left"]){const n="top"===t?"scrollTop":"scrollLeft";s[t]=e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]-Number.parseInt(L(document.body,`margin-${t}`),10)+"px"}for(const t of["height","width"])s[t]=`${e.target.getBoundingClientRect()[t]}px`}else l.originalPosition.value=L(t,"position");for(const[n,a]of Object.entries(s))l.$el.style[n]=a},P=(e,t,n)=>{const l=y("loading");["absolute","fixed","sticky"].includes(n.originalPosition.value)?w(t,l.bm("parent","relative")):k(t,l.bm("parent","relative")),e.fullscreen&&e.lock?k(t,l.bm("parent","hidden")):w(t,l.bm("parent","hidden"))},j=Symbol("ElLoading"),E=(e,n)=>{var l,o,s,a;const i=n.instance,r=e=>b(n.value)?n.value[e]:void 0,u=n=>(e=>{const n=m(e)&&(null==i?void 0:i[e])||e;return n?t(n):n})(r(n)||e.getAttribute(`element-loading-${f(n)}`)),c=null!=(l=r("fullscreen"))?l:n.modifiers.fullscreen,d={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:c,target:null!=(o=r("target"))?o:c?void 0:e,body:null!=(s=r("body"))?s:n.modifiers.body,lock:null!=(a=r("lock"))?a:n.modifiers.lock};e[j]={options:d,instance:$(d)}},O={mounted(e,t){t.value&&E(e,t)},updated(e,t){const n=e[j];t.oldValue!==t.value&&(t.value&&!t.oldValue?E(e,t):t.value&&t.oldValue?b(t.value)&&((e,t)=>{for(const n of Object.keys(t))g(t[n])&&(t[n].value=e[n])})(t.value,n.options):null==n||n.instance.close())},unmounted(e){var t;null==(t=e[j])||t.instance.close()}};export{O as v};

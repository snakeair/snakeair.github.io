import{J as e,Y as t,Z as o,a0 as l,d as n,M as a,a1 as i,a2 as s,r as u,a3 as c,a4 as r,a5 as d,L as m,a6 as p,a7 as v,h as f,Q as h,a8 as g,a9 as b,N as y,aa as k,K as x,ab as O,ac as V,ad as w,ae as S,af as T,ag as H,ah as C,ai as N,R as I,aj as B,ak as j,al as D,am as M,an as $,ao as P,ap as E}from"../default/default-0acc75c5.js";import{m as A,u as L}from"./mount-component-e7c80737.js";const[_,z,F]=e("picker"),R=e=>e.find((e=>!e.disabled))||e[0];function U(e,t){for(let o=t=l(t,0,e.length);o<e.length;o++)if(!e[o].disabled)return o;for(let o=t-1;o>=0;o--)if(!e[o].disabled)return o;return 0}const Y=(e,t,o)=>void 0!==t&&!!e.find((e=>e[o.value]===t));function J(e,t,o){const l=e.findIndex((e=>e[o.value]===t));return e[U(e,l)]}const[K,Q]=e("picker-column"),Z=Symbol(K);var q=n({name:K,props:{value:a,fields:i(Object),options:s(),readonly:Boolean,allowHtml:Boolean,optionHeight:i(Number),swipeDuration:i(a),visibleOptionNum:i(a)},emits:["change","clickOption","scrollInto"],setup(e,{emit:t,slots:o}){let n,a,i,s,g;const b=u(),y=u(),k=u(0),x=u(0),O=c(),V=()=>e.options.length,w=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,S=o=>{const l=U(e.options,o),a=-l*e.optionHeight,i=()=>{const o=e.options[l][e.fields.value];o!==e.value&&t("change",o)};n&&a!==k.value?g=i:i(),k.value=a},T=()=>e.readonly||!e.options.length,H=t=>l(Math.round(-t/e.optionHeight),0,V()-1),C=r((()=>H(k.value))),N=()=>{n=!1,x.value=0,g&&(g(),g=null)},I=e=>{if(!T()){if(O.start(e),n){const e=function(e){const{transform:t}=window.getComputedStyle(e),o=t.slice(7,t.length-1).split(", ")[5];return Number(o)}(y.value);k.value=Math.min(0,e-w())}x.value=0,a=k.value,i=Date.now(),s=a,g=null}},B=()=>{if(T())return;const t=k.value-s,o=Date.now()-i;if(o<300&&Math.abs(t)>15)return void((t,o)=>{const l=Math.abs(t/o);t=k.value+l/.003*(t<0?-1:1);const n=H(t);x.value=+e.swipeDuration,S(n)})(t,o);const l=H(k.value);x.value=200,S(l),setTimeout((()=>{n=!1}),0)},j=()=>{const l={height:`${e.optionHeight}px`};return e.options.map(((a,i)=>{const s=a[e.fields.text],{disabled:u}=a,c=a[e.fields.value],r={role:"button",style:l,tabindex:u?-1:0,class:[Q("item",{disabled:u,selected:c===e.value}),a.className],onClick:()=>(o=>{n||T()||(g=null,x.value=200,S(o),t("clickOption",e.options[o]))})(i)},d={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:s};return f("li",r,[o.option?o.option(a,i):f("div",d,null)])}))};return d(Z),m({stopMomentum:N}),p((()=>{const t=e.options.findIndex((t=>t[e.fields.value]===e.value)),o=-U(e.options,t)*e.optionHeight;k.value=o})),v("touchmove",(o=>{if(T())return;O.move(o),O.isVertical()&&(n=!0,h(o,!0));const u=l(a+O.deltaY.value,-V()*e.optionHeight,e.optionHeight),c=H(u);c!==C.value&&t("scrollInto",e.options[c]),k.value=u;const r=Date.now();r-i>300&&(i=r,s=u)}),{target:b}),()=>f("div",{ref:b,class:Q(),onTouchstartPassive:I,onTouchend:B,onTouchcancel:B},[f("ul",{ref:y,style:{transform:`translate3d(0, ${k.value+w()}px, 0)`,transitionDuration:`${x.value}ms`,transitionProperty:x.value?"all":"none"},class:Q("wrapper"),onTransitionend:N},[j()])])}});const[G]=e("picker-toolbar"),W={title:String,cancelButtonText:String,confirmButtonText:String},X=["cancel","confirm","title","toolbar"],ee=Object.keys(W);var te=n({name:G,props:W,emits:["confirm","cancel"],setup(e,{emit:t,slots:o}){const l=()=>t("cancel"),n=()=>t("confirm"),a=()=>{const t=e.cancelButtonText||F("cancel");return f("button",{type:"button",class:[z("cancel"),g],onClick:l},[o.cancel?o.cancel():t])},i=()=>{const t=e.confirmButtonText||F("confirm");return f("button",{type:"button",class:[z("confirm"),g],onClick:n},[o.confirm?o.confirm():t])};return()=>f("div",{class:z("toolbar")},[o.toolbar?o.toolbar():[a(),o.title?o.title():e.title?f("div",{class:[z("title"),"van-ellipsis"]},[e.title]):void 0,i()]])}});const[oe,le]=e("picker-group"),ne=Symbol(oe);o({tabs:s(),activeTab:b(0),nextStepText:String},W);const ae=o({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:b(44),showToolbar:y,swipeDuration:b(1e3),visibleOptionNum:b(6)},W);var ie=n({name:_,props:o({},ae,{columns:s(),modelValue:s(),toolbarPosition:k("top"),columnsFieldNames:Object}),emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:l,slots:n}){const a=u(),i=u(e.modelValue.slice(0)),{parent:s}=d(ne),{children:c,linkChildren:p}=x(Z);p();const g=r((()=>function(e){return o({text:"text",value:"value",children:"children"},e)}(e.columnsFieldNames))),b=r((()=>O(e.optionHeight))),y=r((()=>function(e,t){const o=e[0];if(o){if(Array.isArray(o))return"multiple";if(t.children in o)return"cascade"}return"default"}(e.columns,g.value))),k=r((()=>{const{columns:o}=e;switch(y.value){case"multiple":return o;case"cascade":return function(e,o,l){const n=[];let a={[o.children]:e},i=0;for(;a&&a[o.children];){const e=a[o.children],s=l.value[i];a=t(s)?J(e,s,o):void 0,!a&&e.length&&(a=J(e,R(e)[o.value],o)),i++,n.push(e)}return n}(o,g.value,i);default:return[o]}})),I=r((()=>k.value.some((e=>e.length)))),B=r((()=>k.value.map(((e,t)=>J(e,i.value[t],g.value))))),j=r((()=>k.value.map(((e,t)=>e.findIndex((e=>e[g.value.value]===i.value[t])))))),D=(e,t)=>{if(i.value[e]!==t){const o=i.value.slice(0);o[e]=t,i.value=o}},M=()=>({selectedValues:i.value.slice(0),selectedOptions:B.value,selectedIndexes:j.value}),$=()=>{c.forEach((e=>e.stopMomentum()));const e=M();return T((()=>{l("confirm",e)})),e},P=()=>l("cancel",M()),E=()=>k.value.map(((t,a)=>f(q,{value:i.value[a],fields:g.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:b.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:e=>((e,t)=>{D(t,e),"cascade"===y.value&&i.value.forEach(((e,t)=>{const o=k.value[t];Y(o,e,g.value)||D(t,o.length?o[0][g.value.value]:void 0)})),T((()=>{l("change",o({columnIndex:t},M()))}))})(e,a),onClickOption:e=>((e,t)=>{const n={columnIndex:t,currentOption:e};l("clickOption",o(M(),n)),l("scrollInto",n)})(e,a),onScrollInto:e=>{l("scrollInto",{currentOption:e,columnIndex:a})}},{option:n.option}))),A=e=>{if(I.value){const t={height:`${b.value}px`},o={backgroundSize:`100% ${(e-b.value)/2}px`};return[f("div",{class:z("mask"),style:o},null),f("div",{class:[N,z("frame")],style:t},null)]}},L=()=>{const t=b.value*+e.visibleOptionNum,o={height:`${t}px`};return f("div",{ref:a,class:z("columns"),style:o},[E(),A(t)])},_=()=>{if(e.showToolbar&&!s)return f(te,C(H(e,ee),{onConfirm:$,onCancel:P}),H(n,X))};let F;V(k,(e=>{e.forEach(((e,t)=>{e.length&&!Y(e,i.value[t],g.value)&&D(t,R(e)[g.value.value])}))}),{immediate:!0}),V((()=>e.modelValue),(e=>{w(e,i.value)||w(e,F)||(i.value=e.slice(0),F=e.slice(0))}),{deep:!0}),V(i,(t=>{w(t,e.modelValue)||(F=t.slice(0),l("update:modelValue",F))}),{immediate:!0}),v("touchmove",h,{target:a});return m({confirm:$,getSelectedOptions:()=>B.value}),()=>{var t,o;return f("div",{class:z()},["top"===e.toolbarPosition?_():null,e.loading?f(S,{class:z("loading")},null):null,null==(t=n["columns-top"])?void 0:t.call(n),L(),null==(o=n["columns-bottom"])?void 0:o.call(n),"bottom"===e.toolbarPosition?_():null])}}});const se="000000",ue=["title","cancel","confirm","toolbar","columns-top","columns-bottom"],ce=["title","loading","readonly","optionHeight","swipeDuration","visibleOptionNum","cancelButtonText","confirmButtonText"],re=(e="",t=se,o=void 0)=>({text:e,value:t,children:o});function de({areaList:e,columnsNum:t,columnsPlaceholder:o}){const{city_list:l={},county_list:n={},province_list:a={}}=e,i=+t>1,s=+t>2,u=new Map;Object.keys(a).forEach((e=>{u.set(e.slice(0,2),re(a[e],e,(()=>{if(i)return o.length?[re(o[0],se,s?[]:void 0)]:[]})()))}));const c=new Map;if(i){const e=()=>{if(s)return o.length?[re(o[1])]:[]};Object.keys(l).forEach((t=>{const o=re(l[t],t,e());c.set(t.slice(0,4),o);const n=u.get(t.slice(0,2));n&&n.children.push(o)}))}s&&Object.keys(n).forEach((e=>{const t=c.get(e.slice(0,4));t&&t.children.push(re(n[e],e))}));const r=Array.from(u.values());if(o.length){const e=s?[re(o[2])]:void 0,t=i?[re(o[1],se,e)]:void 0;r.unshift(re(o[0],se,t))}return r}const me=I(ie),[pe,ve]=e("area");const fe=I(n({name:pe,props:o({},H(ae,ce),{modelValue:String,columnsNum:b(3),columnsPlaceholder:s(),areaList:{type:Object,default:()=>({})}}),emits:["change","confirm","cancel","update:modelValue"],setup(e,{emit:t,slots:o}){const l=u([]),n=u(),a=r((()=>de(e))),i=(...e)=>t("change",...e),s=(...e)=>t("cancel",...e),c=(...e)=>t("confirm",...e);return V(l,(o=>{const l=o.length?o[o.length-1]:"";l&&l!==e.modelValue&&t("update:modelValue",l)}),{deep:!0}),V((()=>e.modelValue),(t=>{if(t){t!==(l.value.length?l.value[l.value.length-1]:"")&&(l.value=[`${t.slice(0,2)}0000`,`${t.slice(0,4)}00`,t].slice(0,+e.columnsNum))}else l.value=[]}),{immediate:!0}),m({confirm:()=>{var e;return null==(e=n.value)?void 0:e.confirm()},getSelectedOptions:()=>{var e;return(null==(e=n.value)?void 0:e.getSelectedOptions())||[]}}),()=>f(me,C({ref:n,modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,class:ve(),columns:a.value,onChange:i,onCancel:s,onConfirm:c},H(e,ce)),H(o,ue))}})),[he,ge]=e("radio-group"),be={disabled:Boolean,iconSize:a,direction:String,modelValue:j,checkedColor:String},ye=Symbol(he);const ke=I(n({name:he,props:be,emits:["change","update:modelValue"],setup(e,{emit:t,slots:o}){const{linkChildren:l}=x(ye);return V((()=>e.modelValue),(e=>t("change",e))),l({props:e,updateValue:e=>t("update:modelValue",e)}),B((()=>e.modelValue)),()=>{var t;return f("div",{class:ge([e.direction]),role:"radiogroup"},[null==(t=o.default)?void 0:t.call(o)])}}})),[xe,Oe]=e("radio");const Ve=I(n({name:xe,props:D,emits:["update:modelValue"],setup(e,{emit:t,slots:o}){const{parent:l}=d(ye),n=()=>{l?l.updateValue(e.name):t("update:modelValue",e.name)};return()=>f(M,C({bem:Oe,role:"radio",parent:l,checked:(l?l.props.modelValue:e.modelValue)===e.name,onToggle:n},e),H(o,["default","icon"]))}}));let we,Se;let Te={type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0};const He=()=>{Se&&Se.toggle(!1)};function Ce(e){var t;if($)return Se||({instance:Se}=A({setup(){const{state:e,toggle:t}=L();return()=>f(E,C(e,{"onUpdate:show":t}),null)}})),e=o({},Te,P(t=e)?t:{message:t}),Se.open(e),clearTimeout(we),e.duration>0&&(we=setTimeout(He,e.duration)),Se}export{fe as A,Ve as R,ke as a,Ce as s};
